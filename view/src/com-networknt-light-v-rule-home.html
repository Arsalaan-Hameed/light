<!--
  ~ Copyright 2015 Network New Technologies Inc.
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->
<script type='text/javascript'>
    angular.module('lightApp').controller('com.networknt.light.RuleHomeCtrl', ['$scope', '$http', '$location', 'toaster', 'modelDataService', function ($scope, $http, $location, toaster, modelDataService) {
        $scope.getValidation = {
            category : 'validation',
            name : 'getValidation',
            readOnly: true,
            data: {}
        };

        $scope.hasValidation = false;

        $scope.fetchResult = function () {
            $scope.getValidation.data.ruleClass = modelDataService.getModelData().ruleClass;
            console.log("ruleClass", $scope.getValidation.data.ruleClass);
            $http.get('api/rs', {params: {cmd: encodeURIComponent(JSON.stringify($scope.getValidation))}})
                    .success(function (result, status, headers, config) {
                        var rule = modelDataService.getModelData();
                        rule.schema = JSON.stringify(result.schema, undefined, 2);
                        console.log("rule.schema", rule.schema);
                        modelDataService.setModelData(rule);
                        $scope.hasValidation = true;
                    })
        };
        $scope.fetchResult();
    }]);
</script>
<div class="container" ng-controller="com.networknt.light.RuleHomeCtrl">
    <div class="row">
        <div class="col-md-12">
            <tabset>
                <tab heading="Rule Admin">
                    <p>
                        <a href="/form/com.networknt.light.rule.update">Rule Source Code Update</a>
                    </p>
                    <p>
                        <a href="/page/com-networknt-light-v-rule-transform-request">Transform Request Rules</a>
                    </p>
                    <p>
                        <a href="/page/com-networknt-light-v-rule-transform-response">Transform Response Rules</a>
                    </p>
                    <p>
                        <a ng-hide="hasValidation" href="/form/com.networknt.light.validation.add">Add Validation Schema</a>
                    </p>
                    <p>
                        <a ng-show="hasValidation" href="/form/com.networknt.light.validation.update">Update Validation Schema</a>
                    </p>
                    <p>
                        <a href="/form/com.networknt.light.rule.publisher.update">Update Rule Publisher</a>
                    </p>
                    <p>
                        <a href="/form/com.networknt.light.rule.subscriber.update">Update Rule Subscriber</a>
                    </p>
                </tab>
            </tabset>
        </div>
    </div>
</div> <!-- /container -->
